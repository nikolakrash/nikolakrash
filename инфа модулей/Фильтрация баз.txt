═══════════════════════════════════════════════════════════════
  МОДУЛЬ: ФИЛЬТРАЦИЯ БАЗЫ
═══════════════════════════════════════════════════════════════

📋 НАЗНАЧЕНИЕ
───────────────────────────────────────────────────────────────
Модуль фильтрует пользователей из базы по различным признакам
и формирует готовые файлы .txt и .csv с отфильтрованными данными.

═══════════════════════════════════════════════════════════════
  ФУНКЦИИ И ВОЗМОЖНОСТИ
═══════════════════════════════════════════════════════════════

1. ВВОД ДАННЫХ
───────────────────────────────────────────────────────────────
   • Загрузка файла (.txt или .csv)
   • Вставка списка в текстовое поле
   
   Поддерживаемые форматы:
   - @username
   - https://t.me/username
   - t.me/username
   - username (без символов)
   - ID: 123456789
   - +79001234567 (номер телефона)
   
   Модуль автоматически нормализует все форматы и удаляет дубликаты.

2. ФИЛЬТРЫ ИСКЛЮЧЕНИЯ
───────────────────────────────────────────────────────────────

   ✅ Исключить ботов
      • Работает БЕЗ аккаунтов (текстовая проверка по суффиксу _bot)
      • Исключает строки, где username заканчивается на "_bot"
      • Пример: @my_bot → исключается

   ✅ Исключить пользователей без @username
      • Работает БЕЗ аккаунтов (текстовая проверка)
      • Исключает строки, которые не содержат username в текстовом формате
      • Оставляет: @username, https://t.me/username, t.me/username
      • Исключает: ID (7824079731), номера телефонов (5849948177)
      
      ⚠️ ВАЖНО: Если включен ТОЛЬКО этот фильтр (или вместе с "Исключить ботов"),
                аккаунты НЕ требуются - фильтрация происходит по тексту!

   ✅ Исключить пользователей со скрытым номером
      • Требует аккаунты (проверка через Telegram API)
      • Исключает пользователей, у которых скрыт номер телефона

   ✅ Удалить пользователей с фото
      • Требует аккаунты (проверка через Telegram API)
      • Исключает пользователей, у которых установлено фото профиля

   ✅ Удалить пользователей без фото
      • Требует аккаунты (проверка через Telegram API)
      • Исключает пользователей без фото профиля
      
      ⚠️ Взаимоисключающий с "Удалить пользователей с фото"

3. НАСТРОЙКИ ЗАПРОСОВ
───────────────────────────────────────────────────────────────

   📊 Интервал между запросами (от и до, в секундах)
      • Минимальная задержка: 0.3 сек (рекомендуется)
      • Максимальная задержка: 1.2 сек (рекомендуется)
      • Чем больше база — тем больше интервал (меньше FloodWait)
      
      ⚠️ Для больших баз используйте несколько аккаунтов для
         распределения нагрузки и снижения риска FloodWait.

4. ФОРМАТ ВЫВОДА
───────────────────────────────────────────────────────────────

   Выберите формат сохраняемых строк в результатах:

   • с @ вначале → @username
   • исключить все символы вначале → username
   • t.me/ → t.me/username
   • https://t.me/ → https://t.me/username

5. АККАУНТЫ
───────────────────────────────────────────────────────────────

   ⚠️ Аккаунты требуются ТОЛЬКО для фильтров, которые проверяют
      данные через Telegram API:
      - Исключить пользователей со скрытым номером
      - Удалить пользователей с фото
      - Удалить пользователей без фото

   ✅ Аккаунты НЕ требуются для:
      - Исключить ботов (работает по тексту)
      - Исключить пользователей без @username (работает по тексту)
      - Комбинация этих двух фильтров (работает по тексту)

   💡 При использовании нескольких аккаунтов:
      • Элементы распределяются по кругу (round-robin)
      • Ускоряет обработку и снижает риск FloodWait

═══════════════════════════════════════════════════════════════
  ПРОЦЕСС РАБОТЫ
═══════════════════════════════════════════════════════════════

1. Загрузите базу (файл или вставьте список)
2. Выберите фильтры исключения
3. (Опционально) Выберите аккаунты (если нужны фильтры с API)
4. Настройте интервал между запросами
5. Выберите формат вывода
6. Нажмите "Фильтровать"

📊 В процессе работы отображается:
   • Всего элементов
   • Проверено
   • Удалено
   • Осталось
   • Лог процесса (в реальном времени)

📥 После завершения доступны:
   • Скачать TXT (отфильтрованная база)
   • Скачать CSV (детальный отчет со всеми данными)

═══════════════════════════════════════════════════════════════
  ПРИМЕРЫ ИСПОЛЬЗОВАНИЯ
═══════════════════════════════════════════════════════════════

ПРИМЕР 1: Только текстовые фильтры (без аккаунтов)
───────────────────────────────────────────────────────────────
Входные данные:
@Spodlivaeva
https://t.me/korolna
@maiyagorbunova
t.me/original_nnn
@woem_woem
@Roza_77zRRR
7824079731
5849948177

Фильтры:
✅ Исключить пользователей без @username
✅ Исключить ботов

Результат (формат: с @ вначале):
@Spodlivaeva
@maiyagorbunova
@woem_woem
@Roza_77zRRR

Исключено:
- 7824079731 (нет username)
- 5849948177 (нет username)
- https://t.me/korolna (если korolna заканчивается на _bot)
- t.me/original_nnn (если original_nnn заканчивается на _bot)

ПРИМЕР 2: Фильтры с проверкой через API (требуют аккаунты)
───────────────────────────────────────────────────────────────
Фильтры:
✅ Исключить ботов
✅ Исключить пользователей со скрытым номером
✅ Удалить пользователей без фото

В этом случае модуль:
1. Подключается к Telegram через выбранные аккаунты
2. Проверяет каждого пользователя через API
3. Применяет все фильтры
4. Формирует результат

═══════════════════════════════════════════════════════════════
  ВАЖНЫЕ ЗАМЕЧАНИЯ
═══════════════════════════════════════════════════════════════

⚠️ ЛИМИТЫ TELEGRAM
   • Фильтры по боту/фото/телефону требуют запросов к Telegram
   • Могут ловить FloodWait при большой базе
   • Для больших баз используйте несколько аккаунтов

⚠️ ПРОИЗВОДИТЕЛЬНОСТЬ
   • Текстовые фильтры (боты, username) работают мгновенно
   • Фильтры с API требуют времени (зависит от размера базы)
   • Интервал между запросами влияет на скорость и риск FloodWait

⚠️ РЕКОМЕНДАЦИИ
   • Для больших баз (>1000 элементов) используйте несколько аккаунтов
   • Увеличьте интервал между запросами (0.5-2 сек) для снижения FloodWait
   • Используйте текстовые фильтры когда возможно (быстрее, без аккаунтов)

═══════════════════════════════════════════════════════════════
  ОТЧЕТЫ
═══════════════════════════════════════════════════════════════

📄 TXT файл:
   • Список отфильтрованных элементов
   • Формат зависит от выбранного типа строк
   • Готов к использованию для рассылок

📊 CSV файл:
   • Детальная информация по каждому элементу:
     - kept (оставлен/удален)
     - reason (причина удаления)
     - input (исходная строка)
     - id (ID пользователя, если найден)
     - username (username, если найден)
     - phone (телефон, если найден)
     - is_bot (является ли ботом)
     - has_photo (есть ли фото)

═══════════════════════════════════════════════════════════════
